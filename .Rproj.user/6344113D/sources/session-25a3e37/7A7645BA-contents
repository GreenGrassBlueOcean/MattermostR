# File: R/get_channel_id_by_display_name.R

#' Get Channel ID by Display Name
#'
#' This function retrieves the channel ID associated with a specified display name from a data frame of channels.
#'
#' @param channels_df A data frame containing channel information. It must include at least two columns:
#'                    `id` (the channel ID) and `display_name` (the name displayed for the channel).
#'                    This is the result of a call to `get_team_channels()`
#' @param display_name A character string representing the display name of the channel for which
#'                     the ID is to be retrieved.
#'
#' @seealso [get_team_channels()]
#' @return A character string containing the channel ID if found, otherwise an error is thrown.
#' @export
#'
#' @examples
#' # Sample channels data frame
#' channels <- data.frame(
#'   id = c("gy91r1kjnbnkdfu6jjoxzcm5ge", "utbtjouxkirniyh9u84oym6mnh"),
#'   display_name = c("Off-Topic", "Town Square")
#' )
#'
#' # Get the channel ID for "Off-Topic"
#' channel_id <- get_channel_id_by_display_name(channels, "Off-Topic")
#' print(channel_id)  # Expected output: "gy91r1kjnbnkdfu6jjoxzcm5ge"
#'
#' # Attempting to get the channel ID for a non-existent channel
#' # This will throw an error
#' # channel_id <- get_channel_id_by_display_name(channels, "Non-Existent Channel")
#'
#' \dontrun{
#' authenticate_mattermost()
#' teams <- list_all_teams()
#' team_channels <- get_team_channels(team_id = teams$id[1])
#' channel_id <- get_channel_id_by_display_name(team_channels, "Off-Topic")
#' }
get_channel_id_by_display_name <- function(channels_df, display_name) {

  # Validate input
  if (!is.data.frame(channels_df) || !all(c("id", "display_name") %in% names(channels_df))) {
    stop("Input must be a data frame containing 'id' and 'display_name' columns.")
  }

  # Search for the channel by display name
  channel_id <- channels_df$id[channels_df$display_name == display_name]

  # Check if a channel was found
  if (length(channel_id) == 0) {
    stop("No channel found with the specified display name.")
  }

  return(channel_id)
}

# File: R/get_all_channels.R

#' List all channels in a Mattermost team
#'
#' @param team_id The ID of the team for which to list channels.
#' @param auth A list containing `base_url` and `headers` for authentication.
#' @param verbose (Logical) If `TRUE`, detailed information about the request and response will be printed.
#'
#' @return A data frame containing details of all channels in the specified team.
#' @export
#' @examples
#' \dontrun{
#' team_id <- "your_team_id_here"
#' channels <- get_all_channels(team_id = team_id)
#' }
get_all_channels <- function(team_id, verbose = FALSE, auth = authenticate_mattermost()) {
  
  # Check if team_id is NULL or empty
  if (is.null(team_id) || !nzchar(team_id)) {
    stop("team_id cannot be empty or NULL")
  }
  
  # Define the endpoint for listing all channels of a specific team
  endpoint <- paste0("/api/v4/teams/", team_id, "/channels")
  
  # Send the request to get all channels
  channels_data <- mattermost_api_request(auth = auth, endpoint = endpoint, method = "GET", verbose = verbose)
  
  # Check if the response contains any channels
  if (length(channels_data) == 0L) {
    warning("No channels found for the specified team ID: ", team_id)
  }
  
  return(channels_data)
}